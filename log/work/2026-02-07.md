
## 2026-02-07 工作紀錄
### 核心功能增強
- **智慧型動態參數查找**：
  - 實作 `sb_set_effect_param` 聯動功能：點開選單時自動掃描目標樂器容器，僅列出實際使用的效果器類型與參數。
  - 支援 ADSR 個別參數 (A/D/S/R) 的即時更新。
  - 實作 Java Reflection 輔助函式 `setEffectParam`，透過 `setLastValue` 確保參數更新不中斷音訊流。
- **起始樣板系統**：
  - 更新擴充功能核心，啟動或新專案時自動載入 `ex_00_play.xml` 結構。
  - 修正新專案狀態同步問題，確保樣板載入後顯示為「New Project (unsaved!)」。
- **UI 與佈局優化**：
  - 統一「設定效果器」積木為多行右對齊排列，提升專業感。
  - 實作「寫入舞台日誌」積木，支援四種日誌等級。
  - 修正變數與函式分類顏色同步問題，確保積木與側邊欄顏色一致。
  - 為音訊效果器建立獨立顏色 `EFFECTS_HUE` (#8E44AD 紫色)，與樂器控制區隔。

### 範例遷移與修復
- **ex_13_Chord_Pad**：
  - 將解析邏輯由「位元遮罩」改為「字串拆分」，符合實體按鍵編號習慣。
  - 為「播放和弦」積木加入樂器選單支援。
- **音訊引擎穩定性**：
  - 修正 `default` 樂器缺少 `Pan` 導致的崩潰問題。
  - 移除重複的 `playBuiltinDrum` Java 方法定義。
  - 強化 Serial 緩衝處理，在舞台端切換 Port 時自動補上 `bufferUntil('
')`。

### 技術架構整理
- 整理了 `media/blocks/audio.js` 中的積木定義方式，將靜態積木保持在 `defineBlocksWithJsonArray` 中，而將具備動態功能的積木轉為手動 `init` 模式。
